<ng-container
  *ngIf="!item.children"
  [ngTemplateOutlet]="item.routerLink ? link : button"
  [ngTemplateOutletContext]="{ $implicit: item }"
></ng-container>

<ng-container
  *ngIf="item.children"
  [ngTemplateOutlet]="subMenu"
  [ngTemplateOutletContext]="{ $implicit: item }"
></ng-container>

<ng-template #link let-menuItem>
  <tui-svg
    [src]="menuItem.iconLeft"
    class="icons8-icon icons8-violet"
  ></tui-svg>
  <a routerLinkActive="active" tuiAppearance="flat" tuiButton>
    {{ menuItem.label }}
  </a>
</ng-template>

<ng-template #button let-menuItem>
  <tui-svg
    [src]="menuItem.iconLeft"
    class="icons8-icon icons8-violet"
  ></tui-svg>
  <button tuiButton>
    {{ menuItem.label }}
  </button>
</ng-template>

<ng-template #subMenu let-menuItem>
  <tui-hosted-dropdown
    [canOpen]="!sidebarExpanded"
    [content]="dropdown"
    [sided]="true"
    [(open)]="open"
  >
    <tui-svg
      [src]="menuItem.iconLeft"
      class="icons8-icon icons8-violet"
    ></tui-svg>
    <button tuiButton (click)="submenu = !submenu">
      {{ menuItem.label }}
    </button>
    <ng-template #dropdown>
      <tui-data-list size="s">
        <ng-container *ngFor="let menuItem of menuItem.children">
          <button tuiOption>{{ menuItem.label }}</button>
        </ng-container>
      </tui-data-list>
    </ng-template>
  </tui-hosted-dropdown>

  <tui-expand [expanded]="submenu && sidebarExpanded">
    <ng-container *ngFor="let item of menuItem.children">
      <app-layout-aside-menu-item
        [item]="item"
        [sidebarExpanded]="sidebarExpanded"
      />
    </ng-container>
  </tui-expand>
</ng-template>
