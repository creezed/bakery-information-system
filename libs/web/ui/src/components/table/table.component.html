<ng-container *tuiLet="service.data$ | async as data">
  <tui-loader
    size="xl"
    class="h-full"
    [overlay]="true"
    [showLoader]="!!(service.isLoading$ | async)"
  >
    <table tuiTable [columns]="tableColumns" class="table">
      <thead>
        <tr tuiThGroup>
          <th *ngFor="let col of columns" tuiTh [resizable]="true">
            {{ col.displayName }}
          </th>
          <th *tuiHead="'actions'" tuiTh [sorter]="null">Действия</th>
        </tr>
      </thead>
      <tbody *ngIf="data" tuiTbody [data]="data">
        <tr *ngFor="let row of data" tuiTr>
          <ng-container *ngFor="let col of columns">
            <ng-container
              *polymorpheusOutlet="
                col.component ?? plain;
                context: { $implicit: row[col.field] }
              "
            />
            <td tuiTd>{{ row[col.field] }}</td>
            <ng-template #plain let-text>
              {{ text }}
            </ng-template>
          </ng-container>
          <ng-container *ngIf="actions">
            <td *tuiCell="'actions'" tuiTd>
              <ng-container
                *polymorpheusOutlet="actions; context: { $implicit: row }"
              />
            </td>
          </ng-container>
        </tr>
      </tbody>
    </table>
  </tui-loader>
</ng-container>
<ng-container *tuiLet="service.total$ | async as total">
  <tui-table-pagination
    *ngIf="total !== null"
    [total]="total"
    class="table-pagination"
  />
</ng-container>
