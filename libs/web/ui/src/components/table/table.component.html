<ng-container *tuiLet="service.data$ | async as data">
  <tui-scrollbar class="grow">
    <tui-loader
      size="xl"
      class="h-full"
      [overlay]="true"
      [showLoader]="!!(service.isLoading$ | async)"
    >
      <table class="tui-table">
        <thead>
          <tr class="tui-table__tr tui-table__tr_hover_disabled">
            <th
              *ngFor="let col of columns"
              class="tui-table__th tui-table__th_font-size_l"
            >
              {{ col.displayName }}
            </th>
            <th *ngIf="actions" class="tui-table__th tui-table__th_font-size_l">
              Действия
            </th>
          </tr>
        </thead>
        <tbody *ngIf="data">
          <tr
            *ngFor="let row of data; trackBy: trackBy"
            class="tui-table__tr tui-table__tr_hover_disabled"
          >
            <ng-container *ngFor="let col of columns">
              <td class="tui-table__td">
                <ng-container
                  *polymorpheusOutlet="
                    col.component ?? plain;
                    context: { $implicit: row[col.field] }
                  "
                />
              </td>
              <ng-template #plain let-text>
                {{ text }}
              </ng-template>
            </ng-container>
            <ng-container *ngIf="actions">
              <td class="tui-table__td">
                <ng-container
                  *polymorpheusOutlet="actions; context: { $implicit: row }"
                />
              </td>
            </ng-container>
          </tr>
        </tbody>
      </table>
    </tui-loader>
  </tui-scrollbar>
</ng-container>

<ng-container *tuiLet="service.total$ | async as total">
  <tui-table-pagination
    *ngIf="total"
    [total]="total"
    (paginationChange)="service.paginationChange($event)"
    class="table-pagination"
  />
</ng-container>
